name: üçé macOS Build

on:
  workflow_call:
    inputs:
      tag:
        description: 'Git tag for release builds.'
        required: false
        type: string

  # Triggers on Pull Requests targeting main
  pull_request:
    branches:
      - main
      - feat/beau/ci-macos

  # Allows manual triggering
  workflow_dispatch:

jobs:
  build-macos:
    name: üçé Build and Deploy macOS via codemagic
    runs-on: ubuntu-latest
    env:
      MACOS_CODEMAGIC_HOOK_URL: ${{ secrets.MACOS_CODEMAGIC_HOOK_URL }}
    steps:
      - name: DEBUG Print Workflow Input Tag
        run: |
          # Make a post request to the codemagic.io webhook
          curl -X POST -H "Content-Type: application/json" -d '{"tag": "${{ inputs.tag }}"}' ${{ env.MACOS_CODEMAGIC_HOOK_URL }}
        shell: bash
